이번 섹션에서는 네트워크와 관련된 프로그램을 만들어본다.
네트워크 프로그래밍은 반드시 병렬 처리로 구현해야 한다.
여기서는 병렬 처리와 스레드의 기본적인 사용 방법을 소개한다.

## 스레드란
기본적으로 PC에서 동작하는 운영체제는 여러 프로그램을 동시에 실행할 수 있게 설계돼 있다.
OS의 각 프로세스가 상호 독립적으로 작동하도록 관리하기 때문이다. 각 프로세스는 독립된 메모리 영역을 할당받는다. '스레드(thread)'는 일반적으로 프로세스가 할당받은 자원을 이용하는 실행단위를 말한다.
프로세스는 최소 1개의 스레드를 갖는다.

많은 프로그래밍 언어에서는 동시에 다른 처리를 할 수 있도록 스레드 기능을 제공한다. 러스트도 스레드 기능을 이용할 수 있다. 표준 라이브러리(std)의 thread가 스레드 기능을 사용할 수 있게 해주는 모듈이다.

```rust
use std::{thread, time};

// 3초간 1초에 한 번 메시지리를 표시하는 함수
fn sleep_print(word: &str) {
	for i in 1..=3 {
		println!("{}: i={}", word, i)
		thread::sleep(time::Duration::from_millis(1000));
	}
}

fn main() {
	// 스레드를 이용하지 않는 경우
	println!("--스레드 없음--")
	sleep_print("스레드 없음");
	
	// 스레드를 이용하는 경우
	println!("--스레드 이용--");
	// 스레드 1
	thread::spawn(|| {sleep_print("토마토")});
	// 스레드 2
	thread::spawn(|| {sleep_print("스위스")});
	//스레드 3
	thread::spawn(|| {sleep_print("별똥별")});
	
	// 메인 스레드
	sleep_print("기러기");
}
```
for 문과 sleep 함수를 이용해 1초에 한 번 메시지를 표시하는 함수다.
(단어): i = {초}형태이다.
sleep_print를 호출해 1초에 한 번씩 총 3버 메시지가 출력된다.

thread::spawn 함수를 이용해 스레드를 3개 만들어서 sleep_print 함수를 실행하고 메인 스레드에도 sleep_print 함수를 실행한다. 즉 총 4개의 스레드가 실행되는 것임 각 스레드는 동작 확인을 위해 이름을 붙였음

이처럼 스레드를 이용하면 프로그램이 순서대로 실행되는 것이 아니라 동시에 실행된다.

스레드를 이용하는 프로그램은 당므과 같이 thread::spawn 함수의 인수에 클로저를 지정한다.

> \[서식] 스레드 생성
> thread::spawn(클로저);

클로저를 이용하는 경우 클로저를 사용하는 함수 안에서 유효한 변수를 이용할 수 있다.
이것을 '환경 캡처'라고 한다. 캡처한 변수에서 소유권 이동이 필요한 경우 클로저에 move를 지정해 명시적 소유권을 이동해야 한다.
스레드를 다루는 프로세스에는 move를 지정하는 경우가 있다.
> \[서식] 스레드 안에서 사용할 변수의 소유권을 이동하는 경우
> thread::spawn(move || { 
> // 소유권 이동 처리
> });

